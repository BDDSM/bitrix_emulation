
Процедура УстановкаПараметровСеанса(ТребуемыеПараметры)
	
	Если ТребуемыеПараметры = Неопределено Тогда
		Возврат;
	КонецЕсли;
	
	//пока прямо тут, но для пущей скорости лучше вынести наружу
	Для Каждого ИмяПараметра Из ТребуемыеПараметры Цикл
		
		Если ИмяПараметра = "ТекущийПользователь" Тогда
			
			ТекущийПользовательИБ = ПользователиИнформационнойБазы.ТекущийПользователь();
		
			Если ПустаяСтрока(ТекущийПользовательИБ.Имя) Тогда
				ВызватьИсключение "Необходимо зарегистрировать хотя бы одного пользователя в базе";
			КонецЕсли;
			
			//ситуации со сменой логина тоже пока не будем отрабатывать.
			Запрос = Новый Запрос(
			"ВЫБРАТЬ ПЕРВЫЕ 1
			|	Пользователи.Ссылка
			|ИЗ
			|	Справочник.Пользователи КАК Пользователи
			|ГДЕ
			|	Пользователи.Код = &Код"
			);
			Запрос.УстановитьПараметр("Код",СокрЛП(ТекущийПользовательИБ.Имя));
			РезультатЗапроса = Запрос.Выполнить();
			//если пустой, то будем ли регать? Вроде были сложности, когда логин=email. Значит, пользователь будет создаваться в другом месте.
			//А это значит, что здесь создавать тоже нет смысла.
			Если РезультатЗапроса.Пустой() Тогда
				ВызватьИсключение "Не завершена регистрация пользователя в базе";
			Иначе
				Выборка = РезультатЗапроса.Выбрать();
				Выборка.Следующий();
				ПараметрыСеанса.ТекущийПользователь = Выборка.Ссылка;
			КонецЕсли;
			
		КонецЕсли;
		
	КонецЦикла;	
	
КонецПроцедуры

